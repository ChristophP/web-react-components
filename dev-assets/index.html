<head>
  <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/document-register-element/1.5.0/document-register-element.js"></script>-->
  <!-- Use this adapter for classes transform instead of babel plugin "transform-custom-elements-classes
    because th plugin needs Reflect.construct, which is not there in IE.
    " -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/1.0.1/custom-elements-es5-adapter.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/1.0.1/webcomponents-sd-ce.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.8/react-with-addons.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.8/react-dom.js"></script>

  <!-- compiled JS -->
  <script src="/bundle.js"></script>
</head>
<body>
  <h1>Web React Components</h1>

  <!-- render the custom element -->
  <my-component
    id="myComponent"
    name="Peter"
    age="45"
    fruits='["apple","orange","banana"]'
    onClickButton="console.log('attribute callback `onclickbutton` triggered', this)"
  >
    I'm a <em>native</em> child
  </my-component>

  <script>
    // create react component
    const h = React.createElement;
    const style = { backgroundColor: '#eee', padding: '1em' };
    function MyComponent(props) {
      const name = props.name;
      const children = props.children;
      const age = props.age || 'unknown';
      const fruits = props.fruits || [];
      const onClickButton = props.onClickButton || Function.prototype;
      const onHoverName = props.onHoverName || Function.prototype;
      return h('div', null,
        h('h1', { onMouseOver: function() { return onHoverName(name); }  }, name),
        h('button', { onClick: onClickButton }, 'Click me!'),
        h('p', null, 'Age: ' + age),
        children && h('div', { style }, children),
        h('ul', null, fruits.map(function(fruit, key) {
          return h('li', { key }, fruit)
        }))
      );
    }

    // register react component as custom element
    WebReactComponents.register(MyComponent, 'my-component', {
      attributes: ['name', 'age', 'fruits'],
      events: ['onClickButton', 'onHoverName'],
    });

    // add some DOM Level 3 event handlers
    const myComponent = document.getElementById('myComponent');
    myComponent.addEventListener('onClickButton', function(e) {
      console.log('Event `onClickButton` triggered', e)
    });
    myComponent.addEventListener('onHoverName', function(e) {
      console.log('Event `onHoverName` triggered', e)
    });
    myComponent.name = 'Fritz';
  </script>
</body>
